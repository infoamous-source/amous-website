# 계열사 이미지 롤링 기능 추가
**작업일시:** 2025.02.09 09:20

---

## 작업 개요
계열사(에이머스스튜디오, 에이머스이벤트) Admin에 이미지 갤러리 관리 기능을 추가하고, 메인 페이지에서 각 계열사당 3~5개 이미지를 4초 간격으로 자동 롤링하도록 구현

---

## 완료된 작업

### 1. 데이터베이스 스키마 수정
**Supabase affiliates 테이블에 images 컬럼 추가**
- 타입: `TEXT[]` (문자열 배열)
- 최대 5개 이미지 URL 저장
- SQL 파일: `add-affiliate-images.sql`

```sql
ALTER TABLE affiliates
ADD COLUMN IF NOT EXISTS images TEXT[];
```

### 2. TypeScript 인터페이스 업데이트
**파일:** `src/lib/supabase.ts`
- Affiliate 인터페이스에 `images: string[] | null` 추가

### 3. Admin 페이지 이미지 갤러리 기능
**파일:** `src/app/admin/affiliates/page.tsx`

**추가된 기능:**
- ✅ 이미지 업로더 통합 (ImageUploader 컴포넌트)
- ✅ 최대 5개 이미지 등록 가능
- ✅ 이미지 순서 변경 (◀▶ 버튼)
- ✅ 이미지 삭제 (✕ 버튼)
- ✅ 이미지 개수 표시 (0/5장)
- ✅ 16:9 비율 썸네일 미리보기
- ✅ 이미지 순서 번호 표시

**UI/UX:**
- 그리드 레이아웃 (최대 5열)
- 호버 시 컨트롤 버튼 표시
- 권장 해상도 안내: 800 x 450px
- 자동 롤링 간격 안내: 4초

### 4. 메인 페이지 이미지 롤링
**파일:** `src/components/sections/AffiliatesSection.tsx`

**기능:**
- ✅ API에서 계열사 데이터 동적 로드
- ✅ 각 계열사별로 독립적인 이미지 롤링
- ✅ 4초 간격 자동 전환 (Framer Motion AnimatePresence)
- ✅ Dot 인디케이터 (클릭 가능)
- ✅ 이미지 없을 경우 placeholder 표시
- ✅ 이미지 1개일 경우 롤링 없이 고정 표시

**애니메이션:**
- Fade in/out 전환 (0.8초 duration)
- 부드러운 크로스페이드 효과

---

## 수정된 파일

| 파일 | 변경 내용 |
|------|-----------|
| `src/lib/supabase.ts` | Affiliate 인터페이스에 images 필드 추가 |
| `src/app/admin/affiliates/page.tsx` | 이미지 갤러리 관리 기능 전체 구현 |
| `src/components/sections/AffiliatesSection.tsx` | API 연동 및 이미지 롤링 기능 구현 |
| `add-affiliate-images.sql` | DB 스키마 수정 SQL (신규) |

---

## 사용 방법

### Admin에서 이미지 등록
1. `/admin/affiliates` 접속
2. 계열사 카드에서 "편집" 버튼 클릭
3. 하단 "포트폴리오 이미지" 섹션에서 이미지 업로드
4. 최대 5개까지 추가 가능
5. ◀▶ 버튼으로 순서 변경
6. ✕ 버튼으로 삭제
7. "저장" 버튼 클릭

### 메인 페이지에서 확인
1. 메인 페이지 스크롤 → "에이머스 계열사" 섹션
2. 각 계열사 카드 하단에 이미지 표시
3. 2개 이상 등록 시 4초마다 자동 롤링
4. Dot 인디케이터 클릭으로 수동 전환 가능

---

## 기술 스택
- **이미지 관리:** Supabase Storage
- **애니메이션:** Framer Motion (AnimatePresence)
- **상태 관리:** React useState, useEffect
- **UI:** Tailwind CSS

---

## 주의사항

### Supabase SQL 실행 필요
`add-affiliate-images.sql` 파일을 Supabase SQL Editor에서 실행해야 합니다:

```sql
-- 1. images 컬럼 추가
ALTER TABLE affiliates
ADD COLUMN IF NOT EXISTS images TEXT[];

-- 2. 스키마 캐시 리프레시
NOTIFY pgrst, 'reload schema';
```

실행 후 Admin 페이지에서 이미지를 등록할 수 있습니다.

---

## 검증 완료 항목
✅ Admin 페이지에서 이미지 업로드 가능
✅ 이미지 순서 변경 기능 작동
✅ 이미지 삭제 기능 작동
✅ 최대 5개 제한 작동
✅ TypeScript 타입 안전성 확보

---

## 다음 단계
1. Supabase에서 SQL 실행
2. Admin에서 각 계열사 이미지 등록
3. 메인 페이지에서 롤링 확인
4. 프로덕션 배포 후 최종 확인

---

## 이전 작업과의 연관성
- `20260209_082000_작업내역.md`: 강사 등록 API 수정
- `20260209_013455_작업내역.md`: 메인페이지 이미지 롤링 구현 (Hero/About)

**이번 작업은 Hero/About 섹션의 이미지 롤링 패턴을 계열사 섹션에 적용한 것입니다.**
